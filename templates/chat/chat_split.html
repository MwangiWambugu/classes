{% extends "base.html" %}
{% load static %}


  <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
{% block content %}
  <style>
    body { font-family: Inter, sans-serif; background:#f6f8fb; margin:0; padding:0; }
    .split { display:flex; height:100vh; }
    .left { width: 320px; border-right:1px solid #e6e9ef; overflow:auto; background:#fff; padding:16px; }
    .right { flex:1; display:flex; flex-direction:column; padding:16px; }
    .channel-item { padding:10px;border-radius:8px; margin-bottom:6px; cursor:pointer; }
    .channel-item:hover { background:#f0f6ff; }
    .channel-item.active { background:#e7f0ff; font-weight:600; color:#0d6efd; }
    .chat-box { flex:1; background:#ffffff; border-radius:8px; padding:12px; overflow:auto; border:1px solid #e6e9ef; }
    .message { margin-bottom:10px; }
    .message .meta { font-size:12px; color:#6b7280; }
    .composer { display:flex; gap:8px; margin-top:12px; }
    .composer input { flex:1; padding:10px; border-radius:8px; border:1px solid #dfe6f2; }
    .composer button { padding:10px 16px; border-radius:8px; background:#0d6efd; color:white; border:none; }
    .create-form { display:flex; gap:8px; margin-top:12px; }
  </style>
</head>
<body>
<div class="split">
  <div class="left">
    <h4>Channels</h4>
    <div id="channelsList">
      {% for ch in channels %}
        <div class="channel-item {% if current and ch.id == current.id %}active{% endif %}">

             data-name="{{ ch.name }}">
          {{ ch.name }}
        </div>
      {% empty %}
        <p>No channels yet</p>
      {% endfor %}
    </div>

    <form id="createChannelForm" class="create-form" method="post" action="{% url 'create_channel' %}">
      {% csrf_token %}
      <input type="text" name="room_name" placeholder="New channel" required>
      <button type="submit">Create</button>
    </form>
  </div>

  <div class="right">
    <div>
      <h3 id="roomTitle">{% if current %}{{ current.name }}{% else %}No channel{% endif %}</h3>
    </div>
    <div id="chatBox" class="chat-box">
      {% if messages %}
        {% for msg in messages %}
          <div class="message">
            <strong>
    {% if msg.user %}
        {{ msg.user.username }}
    {% else %}
        Anonymous
    {% endif %}
</strong>
            <div>{{ msg.content }}</div>
            <div class="meta">{{ msg.timestamp }}</div>
          </div>
        {% endfor %}
      {% endif %}
    </div>

    <div class="composer">
      <input id="messageInput" type="text" placeholder="Type a message..." />
      <button id="sendBtn">Send</button>
    </div>
  </div>
</div>
<script src="{% static 'js/chat_split.js' %}"></script>
{% endblock %}